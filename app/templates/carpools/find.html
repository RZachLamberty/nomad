{%- extends "_template.html" %}
{%- import "bootstrap/wtf.html" as wtf %}

{#
    load all carpools as geoJSON from /carpools/starts.geojson

    /carpools/find.html
        sort features by leave time
        zoom map to fit all features
        if user geolocation results,
            sort features by distance from user location
            zoom map to fit features within 100km or at least 3 features

    /carpools/find.html?q=92683
        get lat/lng of query from Google Geocoder
        sort features by distance from query location
        zoom map to fit features within 100km or at least 3 features
#}

{% block scripts %}
<script>
    // sanitized query from URL: q=12345
    const userQuery = '{{user_query}}';
    const geoJSONUrl = "{{ url_for('carpool.start_geojson') }}?";
    const newCarpoolUrl = "{{ url_for('carpool.new', lat=loc_lat, lon=loc_lon) }}";
</script>
<script type="text/javascript" src="{{ url_for('static', filename='js/find.js') }}"></script>
{{super()}}
{% endblock %}

{% block site %}

<div class="content constrained">

    <div class="carpool-results">
        <h1>
            Find rides near
            <input type="text" name="q" id="locationQuery" class="form-control input-lg" placeholder="Zip code or City, State" value="{{userQuery}}" />
        </h1>
        <div class="geocode-error">
            Sorry, we can't understand that location. Please try again.
        </div>
        <div id="search-results">
        </div>
    </div>

    <div class="carpool-map">
        <div id="background-map"></div>
    </div>

</div>

{% endblock %}
